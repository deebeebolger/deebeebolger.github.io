<div class="mermaid">
    {{ .Inner | safeHTML }}
</div>

{{ if le (.Page.Scratch.Get "mermaidInserted") 0 }}

{{ .Page.Scratch.Add "mermaidInserted" 1 }}

{{ $mermaid := resources.Get "js/mermaid.js" | minify | fingerprint }}
<script type="application/javascript" src="{{ $mermaid.Permalink }}" defer></script>
<script type="module">
    mermaid.initialize({});
</script>

{{ end }}